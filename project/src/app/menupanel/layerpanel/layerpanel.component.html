
	<div class="form-group">
		<div class="input-group">
            <input type="text" class="form-control" [(ngModel)]="searchText" [disabled]="searchMode">
            <div class="input-group-append">
                <button *ngIf="!searchMode" tabindex="-1" class="btn btn-light" type="button" (click)="search()"><i class="fa fa-search"></i></button>
                <button *ngIf="searchMode" tabindex="-1" class="btn btn-light" type="button" (click)="clearSearch()"><i class="fa fa-ban"></i></button>
                <button tabindex="-1" data-toggle="dropdown" class="btn btn-light dropdown-toggle" type="button">
                    <i class="fa fa-ellipsis-h"></i>
                </button>
                <ul id="menu-option-dropdown" class="dropdown-menu">
                    <li>
                        <a (click)="searchActive()"><i class="fa fa-eye"></i> View Active</a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a (click)="searchImage()"><i class="fa fa-image"></i> Image Layer</a>
                    </li>
                    <li>
                        <a (click)="searchData()"><i class="fa fa-sliders"></i> Data Layer</a>
                    </li>
                </ul>
            </div>
          </div>
	</div>
	<li *ngFor="let layerGroup of layerGroups | getKey" >

	   		<a [hidden]="layerGroup.value.hide" (click) = "layerGroup.value.loaded=layerGroup.value;layerGroup.value.expanded = !layerGroup.value.expanded;"
			    [ngClass]="{'highlight': isLayerGroupVisible(layerGroup.value)}">
                {{layerGroup.key}}
				<i class="fa fa-arrow-circle-down" [ngClass]="{'submenu-open-inline':isLayerGroupVisible(layerGroup.value), 'hidden':!isLayerGroupVisible(layerGroup.value) }" ></i>
	        </a>
			<ul *ngIf="layerGroup.value.loaded" [ngClass]="{'submenu-open-block':layerGroup.value.expanded, 'hidden':!layerGroup.value.expanded}">
				<li *ngFor="let layer of layerGroup.value.loaded" [ngClass]="{'active': layer.expanded}">
					<a [hidden]="layer.hide" (click)="layer.expanded = !layer.expanded;" [ngClass]="{'highlight': layer.expanded}">
						<div class="layerLoadCtrl">
							<span *ngIf="uiLayerModels[layer.id].statusMap.renderStarted" class="float-right project-percentage hasEvent light-blue">
								<u (click)="openStatusReport(uiLayerModels[layer.id]); $event.stopPropagation();">{{uiLayerModels[layer.id].statusMap.completePercentage}}</u>
							</span>
							<div>
								<i *ngIf="uiLayerModels[layer.id].statusMap.renderStarted" class="fa fa-times red" (click) = "removeLayer(layer);$event.stopPropagation();"></i>
								{{layer.name}}
								<i *ngIf="layer.expanded && !uiLayerModels[layer.id].statusMap.renderStarted" class="fa fa-arrow-circle-down"></i>
							</div>
							<div *ngIf="uiLayerModels[layer.id].statusMap.renderStarted" class="progress progress-xs" style="height: 5px">
								<div class="progress-bar bg-gradient-blue-purple" [style.width]="uiLayerModels[layer.id].statusMap.completePercentage" role="progressbar"></div>
							</div>
							<div *ngIf="uiLayerModels[layer.id].statusMap.renderStarted || uiLayerModels[layer.id].statusMap.renderComplete" class="opacity-slider-panel d-flex" (click)="$event.stopPropagation()">
								<div class="opacity-label">Opacity {{ uiLayerModels[layer.id].opacity }}%&nbsp;</div>
								<mat-slider [min]="0" [max]="100" class="opacity-slider flex-grow-1" [(ngModel)]="uiLayerModels[layer.id].opacity" (input)="layerOpacityChange($event, layer.id)"></mat-slider>
							</div>
						</div>

					</a>
					<div [hidden]="!layer.expanded || layer.hide" class="sidebar-card-menu-show">

						 <div class="card card-info card-with-tabs layer-card animated  slideInRight">

							<div class="card-header">
								<ul id="card-tab" class="nav nav-tabs">
									<li (click)="selectTabPanel(layer.id,'filterpanel')" [ngClass]="{'active': uiLayerModels[layer.id].tabpanel.filterpanel.expanded}"><a data-toggle="tab"><i class="fa fa-filter"></i> <span class="d-none d-sm-inline">Filter</span></a></li>
									<li (click)="selectTabPanel(layer.id,'infopanel')" [ngClass]="{'active': uiLayerModels[layer.id].tabpanel.infopanel.expanded}"><a data-toggle="tab"><i class="fa fa-info-circle"></i> <span class="d-none d-sm-inline">Info</span></a></li>
									<li (click)="selectTabPanel(layer.id,'downloadpanel')" [ngClass]="{'active': uiLayerModels[layer.id].tabpanel.downloadpanel.expanded}" class="d-none d-md-block"><a data-toggle="tab"><i class="fa fa-download"></i> <span>Download</span></a></li>
								</ul>

							</div>

							<div id="card-tab-content" class="tab-content ">

								<div class="tab-pane fade" [ngClass]="{'show active': uiLayerModels[layer.id].tabpanel.filterpanel.expanded}">
									<app-filter-panel *ngIf="uiLayerModels[layer.id].tabpanel.filterpanel.expanded "[layer]=layer></app-filter-panel>
								</div>

								<div class="tab-pane fade" [ngClass]="{'show active': uiLayerModels[layer.id].tabpanel.infopanel.expanded}">
									<info-panel *ngIf="uiLayerModels[layer.id].tabpanel.infopanel.expanded" [expanded]="uiLayerModels[layer.id].tabpanel.infopanel.expanded" [cswRecords]=layer.cswRecords [layer]=layer ></info-panel>
								</div>
								<div class="tab-pane fade" [ngClass]="{'show active': uiLayerModels[layer.id].tabpanel.downloadpanel.expanded}">
									<app-download-panel *ngIf="uiLayerModels[layer.id].tabpanel.downloadpanel.expanded" [layer]=layer></app-download-panel>
								</div>

							</div>

						</div>
					</div>
				</li>
			</ul>

	</li>
